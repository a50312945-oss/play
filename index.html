<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>PhotoPPT Mobile Inline v2</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b0f19">
  <style>
    :root{ --bg:#0b0f19; --card:#121826; --muted:#9aa4b2; --stroke:#273042; --accent:#06b6d4; --accent2:#22d3ee; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:var(--bg);color:#e5e7eb;font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans TC,Helvetica,Arial;padding-bottom:90px}
    header{position:sticky;top:0;background:linear-gradient(180deg,#0b0f19 0%,rgba(11,15,25,.85) 100%);backdrop-filter:blur(6px);border-bottom:1px solid var(--stroke);z-index:5}
    .wrap{max-width:980px;margin:0 auto;padding:12px}
    h1{margin:0;font-size:18px;line-height:1.2}
    .muted{color:var(--muted)}
    .card{background:var(--card);border:1px solid var(--stroke);border-radius:16px;box-shadow:0 6px 30px rgba(0,0,0,.35);margin:12px}
    .card .body{padding:12px}
    h2{font-size:18px;margin:0 0 8px 0}
    label.inline{display:flex;align-items:center;gap:8px;margin:8px 0}
    input[type="text"], input[type="number"], input[type="date"], textarea{width:100%;background:#0f1625;color:#e5e7eb;border:1px solid #263146;border-radius:12px;padding:12px;font-size:16px}
    textarea{min-height:100px}
    .sec{border:1px dashed #334155;border-radius:14px;padding:10px;margin-top:8px}
    .chips{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px;margin-top:8px}
    .thumb{position:relative;border:1px solid #263146;background:#0f1625;border-radius:12px;overflow:hidden}
    .thumb img{width:100%;height:90px;object-fit:cover;display:block}
    .thumb .meta{position:absolute;right:6px;bottom:6px;font-size:12px;color:#cbd5e1;background:rgba(2,6,23,.55);backdrop-filter:blur(2px);padding:2px 6px;border-radius:8px;border:1px solid #263146}
    .btn{appearance:none;border:none;border-radius:12px;padding:10px 14px;background:#1f2937;color:#e5e7eb;border:1px solid #2b364d;cursor:pointer;font-size:14px}
    .btn.primary{background:linear-gradient(180deg,var(--accent2),var(--accent));color:#03222a;border:none;font-weight:700}
    .btn.ghost{background:#0f1625}
    .btn.small{padding:8px 10px;font-size:13px;border-radius:10px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:640px){ .row{grid-template-columns:1fr} .chips{grid-template-columns:repeat(2,minmax(0,1fr))} }
    footer.toolbar{position:fixed;left:0;right:0;bottom:0;z-index:10;background:rgba(11,15,25,.85);border-top:1px solid var(--stroke);backdrop-filter:blur(6px);padding:8px}
    .toolbar .wrap{display:flex;gap:8px}
    .toolbar .wrap .btn{flex:1}
    .hint{font-size:12px;color:#9aa4b2;margin-top:4px}
  </style>
</head>
<body>
<header>
  <div class="wrap" style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
    <h1>📱 PhotoPPT Mobile Inline v2 <span class="muted">（對齊 Desktop inline 版）</span></h1>
    <div style="display:flex;gap:8px">
      <button class="btn ghost" id="btnLoadJson">📂 載入</button>
      <button class="btn ghost" id="btnSaveJson">💾 存檔</button>
    </div>
  </div>
</header>

<main id="main">
  <!-- 0 基本資訊 -->
  <section class="card"><div class="body">
    <h2>0) 基本資訊</h2>
    <div class="row">
      <div><label class="muted">案場名稱</label><input id="site_name" type="text" placeholder="例：XX國小屋頂案"/></div>
      <div><label class="muted">現勘日期</label><input id="survey_date" type="date"/></div>
      <div><label class="muted">現勘人員</label><input id="inspector" type="text" placeholder="例：王小明"/></div>
      <div><label class="muted">聯絡人/電話（選填）</label><input id="contact" type="text" inputmode="tel" placeholder="例：林先生 09xx-xxx-xxx"/></div>
    </div>
  </div></section>

  <!-- 1 案場施作型式 -->
  <section class="card"><div class="body">
    <h2>1) 案場施作型式</h2>
    <div class="sec">
      <strong>◎ 屋頂型</strong>
      <label class="inline"><input type="checkbox" id="bld_size"> 建物尺寸</label><div id="ph-bld_size" class="chips"></div>
      <label class="inline"><input type="checkbox" id="shade_pos"> 遮蔭相對位置及高度</label><div id="ph-shade_pos" class="chips"></div>
      <label class="inline"><input type="checkbox" id="obs_pos"> 障礙物相對位置及尺寸</label><div id="ph-obs_pos" class="chips"></div>
      <div class="sec">
        <div class="muted" style="margin-bottom:6px">屋頂型式</div>
        <label class="inline"><input type="checkbox" data-arr="roof_types" value="RC屋頂"> RC屋頂</label><div id="ph-roof_RC屋頂" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="roof_types" value="浪板屋頂"> 浪板屋頂</label><div id="ph-roof_浪板屋頂" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="roof_types" value="混合型屋頂"> 混合型屋頂</label><div id="ph-roof_混合型屋頂" class="chips"></div>
      </div>
      <div class="sec">
        <div class="muted" style="margin-bottom:6px">是否有障礙物（可複選）</div>
        <label class="inline"><input type="checkbox" data-arr="obstacles" value="水塔"> 水塔</label><div id="ph-obst_水塔" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="obstacles" value="冷氣"> 冷氣</label><div id="ph-obst_冷氣" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="obstacles" value="通風球"> 通風球</label><div id="ph-obst_通風球" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="obstacles" value="太陽能熱水器"> 太陽能熱水器</label><div id="ph-obst_太陽能熱水器" class="chips"></div>
        <label class="inline">其他 <input id="obst_other" type="text" placeholder="自填"/></label><div id="ph-obst_其他" class="chips"></div>
      </div>
      <div class="sec">
        <div class="muted" style="margin-bottom:6px">是否有遮陰</div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="屋凸"> 屋凸</label><div id="ph-shade_屋凸" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="水塔"> 水塔</label><div id="ph-shade_水塔" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="電塔"> 電塔</label><div id="ph-shade_電塔" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="廣播塔"> 廣播塔</label><div id="ph-shade_廣播塔" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="山遮"> 山遮</label><div id="ph-shade_山遮" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="高樓"> 高樓（約 <input id="high_rise_f" type="number" style="width:90px"> 樓）</label><div id="ph-shade_高樓" class="chips"></div>
      </div>
    </div>

    <div class="sec">
      <strong>◎ 地面型</strong>
      <label class="inline"><input type="checkbox" data-arr="ground_types" value="一般地面型"> 一般地面型</label><div id="ph-ground_一般地面型" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="ground_types" value="風雨球場"> 風雨球場</label><div id="ph-ground_風雨球場" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="ground_types" value="停車場"> 停車場</label><div id="ph-ground_停車場" class="chips"></div>
    </div>
  </div></section>

  <!-- 2 空拍 -->
  <section class="card"><div class="body">
    <h2>2) 空拍</h2>
    <div class="sec">
      <label class="inline"><input type="checkbox" data-arr="drone" value="可空拍"> 可空拍</label><div id="ph-drone_可空拍" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone" value="禁航區"> 禁航區</label><div id="ph-drone_禁航區" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone" value="限高"> 限高（<input id="drone_limit" type="number" style="width:90px"> 公尺）</label><div id="ph-drone_限高" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="北面空拍"> 北面空拍</label><div id="ph-dronedir_北面空拍" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="西面空拍"> 西面空拍</label><div id="ph-dronedir_西面空拍" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="南面空拍"> 南面空拍</label><div id="ph-dronedir_南面空拍" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="東面空拍"> 東面空拍</label><div id="ph-dronedir_東面空拍" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="正90度空拍"> 正90度空拍</label><div id="ph-dronedir_正90度空拍" class="chips"></div>
    </div>
  </div></section>

  <!-- 3 饋線 -->
  <section class="card"><div class="body">
    <h2>3) 饋線</h2>
    <div class="sec">
      <label class="inline"><span class="muted" style="width:120px;display:inline-block">饋線代碼</span> <input id="feeder_code" type="text"/></label>
      <label class="inline"><span class="muted" style="width:120px;display:inline-block">饋線容量 (kW)</span> <input id="feeder_kw" type="number"/></label>
    </div>
  </div></section>

  <!-- 4 爬梯狀況 -->
  <section class="card"><div class="body">
    <h2>4) 爬梯狀況</h2>
    <div class="sec">
      <label class="inline">現場是否有既設爬梯 <input type="radio" name="ladder_exist" value="是"> 是 <input type="radio" name="ladder_exist" value="否" style="margin-left:14px"> 否</label>
      <div id="ph-ladder_exist" class="chips" style="display:none"></div>
      <label class="inline">是否需要新設爬梯 <input type="radio" name="ladder_new" value="是"> 是 <input type="radio" name="ladder_new" value="否" style="margin-left:14px"> 否</label>
      <div id="ph-ladder_new" class="chips" style="display:none"></div>
    </div>
  </div></section>

  <!-- 5 併接電壓 -->
  <section class="card"><div class="body">
    <h2>5) 併接電壓等級</h2>
    <div class="sec">
      <label class="inline"><span class="muted" style="width:160px;display:inline-block">併接電壓等級 (V)</span> <input id="grid_voltage" type="number" placeholder="例如：380/11400/22800"/></label>
    </div>
  </div></section>

  <!-- 6 併接點 -->
  <section class="card"><div class="body">
    <h2>6) 併接點</h2>
    <div class="sec">
      <label class="inline"><input type="checkbox" data-arr="poc" value="新設台電配電電櫃+新設責任分界點"> 新設台電配電電櫃 + 新設責任分界點</label><div id="ph-poc_新設台電配電電櫃+新設責任分界點" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="poc" value="既設台電配電電櫃+新設責任分界點"> 既設台電配電電櫃 + 新設責任分界點</label><div id="ph-poc_既設台電配電電櫃+新設責任分界點" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="poc" value="僅既設責任分界點"> 僅既設責任分界點</label><div id="ph-poc_僅既設責任分界點" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="poc" value="併內線"> 併內線</label><div id="ph-poc_併內線" class="chips"></div>
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">電號</span> <input id="meter_no" type="text" inputmode="numeric" placeholder="例：1234567890"/></label>
    </div>
  </div></section>

  <!-- 7 設備預計設置位置（照片化） -->
  <section class="card"><div class="body">
    <h2>7) 設備預計設置位置</h2>
    <div class="sec">
      <div><span class="muted">太陽光電錶箱</span><div id="ph-loc_pv_meter" class="chips"></div></div>
      <div><span class="muted">機房</span><div id="ph-loc_room" class="chips"></div></div>
      <div><span class="muted">高壓設備</span><div id="ph-loc_hv" class="chips"></div></div>
      <div><span class="muted">台電配電場</span><div id="ph-loc_taipower" class="chips"></div></div>
      <div><span class="muted">自備桿</span><div id="ph-loc_pole" class="chips"></div></div>
      <div><span class="muted">開關箱</span><div id="ph-loc_switch" class="chips"></div></div>
    </div>
  </div></section>

  <!-- 8 施工路線與暫放 -->
  <section class="card"><div class="body">
    <h2>8) 施工路線與物料暫放</h2>
    <div class="sec">
      <label class="inline">現場是否有施工路線 <input type="radio" name="has_route" value="否"> 否 <input type="radio" name="has_route" value="是" style="margin-left:14px"> 是</label>
      <div id="ph-route" class="chips" style="display:none"></div>
      <label class="inline">道路寬 <input id="route_width" type="number" style="width:100px"> 公尺</label>
      <label class="inline">現場是否有物料暫放區 <input type="radio" name="has_staging" value="是"> 是 <input type="radio" name="has_staging" value="否" style="margin-left:14px"> 否</label>
    </div>
  </div></section>

  <!-- 9 既設容量 -->
  <section class="card"><div class="body">
    <h2>9) 現場既設太陽光電容量</h2>
    <div class="sec">
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">名稱 1</span> <input id="exist_name1" type="text" style="width:200px"> <span class="muted" style="width:90px;display:inline-block;margin-left:12px">容量(kW)</span> <input id="exist_kw1" type="number" style="width:120px"></label>
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">名稱 2</span> <input id="exist_name2" type="text" style="width:200px"> <span class="muted" style="width:90px;display:inline-block;margin-left:12px">容量(kW)</span> <input id="exist_kw2" type="number" style="width:120px"></label>
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">名稱 3</span> <input id="exist_name3" type="text" style="width:200px"> <span class="muted" style="width:90px;display:inline-block;margin-left:12px">容量(kW)</span> <input id="exist_kw3" type="number" style="width:120px"></label>
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">名稱 4</span> <input id="exist_name4" type="text" style="width:200px"> <span class="muted" style="width:90px;display:inline-block;margin-left:12px">容量(kW)</span> <input id="exist_kw4" type="number" style="width:120px"></label>
    </div>
  </div></section>

  <!-- 10 特別約定事項 -->
  <section class="card"><div class="body">
    <h2>10) 特別約定事項</h2>
    <div class="sec">
      <label class="muted">特別約定事項</label>
      <textarea id="special_notes" placeholder="請填寫限制、配合事項、里程碑等…"></textarea>
    </div>
  </div></section>
</main>

<footer class="toolbar">
  <div class="wrap">
    <button class="btn ghost" id="btnScrollTop">⬆️ 回到頂端</button>
    <button class="btn primary" id="btnExport">⬇️ 匯出PPT</button>
  </div>
  <div class="wrap"><div class="hint">提示：手機可直接打開相機拍照上傳（不需安裝 App）。</div></div>
</footer>

<script src="https://unpkg.com/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
<script src="app.js"></script>
<script>
  if ('serviceWorker' in navigator) window.addEventListener('load', ()=> navigator.serviceWorker.register('./sw.js'));
</script>
</body>
</html>
