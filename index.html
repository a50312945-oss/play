<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>PhotoPPT Mobile Inline v2</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b0f19">
  <style>
    :root{ --bg:#0b0f19; --card:#121826; --muted:#9aa4b2; --stroke:#273042; --accent:#06b6d4; --accent2:#22d3ee; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;background:var(--bg);color:#e5e7eb;font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans TC,Helvetica,Arial;padding-bottom:90px}
    header{position:sticky;top:0;background:linear-gradient(180deg,#0b0f19 0%,rgba(11,15,25,.85) 100%);backdrop-filter:blur(6px);border-bottom:1px solid var(--stroke);z-index:5}
    .wrap{max-width:980px;margin:0 auto;padding:12px}
    h1{margin:0;font-size:18px;line-height:1.2}
    .muted{color:var(--muted)}
    .card{background:var(--card);border:1px solid var(--stroke);border-radius:16px;box-shadow:0 6px 30px rgba(0,0,0,.35);margin:12px}
    .card .body{padding:12px}
    h2{font-size:18px;margin:0 0 8px 0}
    label.inline{display:flex;align-items:center;gap:8px;margin:8px 0}
    input[type="text"], input[type="number"], input[type="date"], textarea{width:100%;background:#0f1625;color:#e5e7eb;border:1px solid #263146;border-radius:12px;padding:12px;font-size:16px}
    textarea{min-height:100px}
    .sec{border:1px dashed #334155;border-radius:14px;padding:10px;margin-top:8px}
    .chips{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px;margin-top:8px}
    .thumb{position:relative;border:1px solid #263146;background:#0f1625;border-radius:12px;overflow:hidden}
    .thumb img{width:100%;height:90px;object-fit:cover;display:block}
    .thumb .meta{position:absolute;right:6px;bottom:6px;font-size:12px;color:#cbd5e1;background:rgba(2,6,23,.55);backdrop-filter:blur(2px);padding:2px 6px;border-radius:8px;border:1px solid #263146}
    .btn{appearance:none;border:none;border-radius:12px;padding:10px 14px;background:#1f2937;color:#e5e7eb;border:1px solid #2b364d;cursor:pointer;font-size:14px}
    .btn.primary{background:linear-gradient(180deg,var(--accent2),var(--accent));color:#03222a;border:none;font-weight:700}
    .btn.ghost{background:#0f1625}
    .btn.small{padding:8px 10px;font-size:13px;border-radius:10px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:640px){ .row{grid-template-columns:1fr} .chips{grid-template-columns:repeat(2,minmax(0,1fr))} }
    footer.toolbar{position:fixed;left:0;right:0;bottom:0;z-index:10;background:rgba(11,15,25,.85);border-top:1px solid var(--stroke);backdrop-filter:blur(6px);padding:8px}
    .toolbar .wrap{display:flex;gap:8px}
    .toolbar .wrap .btn{flex:1}
    .hint{font-size:12px;color:#9aa4b2;margin-top:4px}
  </style>
</head>
<body>
<header>
  <div class="wrap" style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
    <h1>ğŸ“± PhotoPPT Mobile Inline v2 <span class="muted">ï¼ˆå°é½Š Desktop inline ç‰ˆï¼‰</span></h1>
    <div style="display:flex;gap:8px">
      <button class="btn ghost" id="btnLoadJson">ğŸ“‚ è¼‰å…¥</button>
      <button class="btn ghost" id="btnSaveJson">ğŸ’¾ å­˜æª”</button>
    </div>
  </div>
</header>

<main id="main">
  <!-- 0 åŸºæœ¬è³‡è¨Š -->
  <section class="card"><div class="body">
    <h2>0) åŸºæœ¬è³‡è¨Š</h2>
    <div class="row">
      <div><label class="muted">æ¡ˆå ´åç¨±</label><input id="site_name" type="text" placeholder="ä¾‹ï¼šXXåœ‹å°å±‹é ‚æ¡ˆ"/></div>
      <div><label class="muted">ç¾å‹˜æ—¥æœŸ</label><input id="survey_date" type="date"/></div>
      <div><label class="muted">ç¾å‹˜äººå“¡</label><input id="inspector" type="text" placeholder="ä¾‹ï¼šç‹å°æ˜"/></div>
      <div><label class="muted">è¯çµ¡äºº/é›»è©±ï¼ˆé¸å¡«ï¼‰</label><input id="contact" type="text" inputmode="tel" placeholder="ä¾‹ï¼šæ—å…ˆç”Ÿ 09xx-xxx-xxx"/></div>
    </div>
  </div></section>

  <!-- 1 æ¡ˆå ´æ–½ä½œå‹å¼ -->
  <section class="card"><div class="body">
    <h2>1) æ¡ˆå ´æ–½ä½œå‹å¼</h2>
    <div class="sec">
      <strong>â— å±‹é ‚å‹</strong>
      <label class="inline"><input type="checkbox" id="bld_size"> å»ºç‰©å°ºå¯¸</label><div id="ph-bld_size" class="chips"></div>
      <label class="inline"><input type="checkbox" id="shade_pos"> é®è”­ç›¸å°ä½ç½®åŠé«˜åº¦</label><div id="ph-shade_pos" class="chips"></div>
      <label class="inline"><input type="checkbox" id="obs_pos"> éšœç¤™ç‰©ç›¸å°ä½ç½®åŠå°ºå¯¸</label><div id="ph-obs_pos" class="chips"></div>
      <div class="sec">
        <div class="muted" style="margin-bottom:6px">å±‹é ‚å‹å¼</div>
        <label class="inline"><input type="checkbox" data-arr="roof_types" value="RCå±‹é ‚"> RCå±‹é ‚</label><div id="ph-roof_RCå±‹é ‚" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="roof_types" value="æµªæ¿å±‹é ‚"> æµªæ¿å±‹é ‚</label><div id="ph-roof_æµªæ¿å±‹é ‚" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="roof_types" value="æ··åˆå‹å±‹é ‚"> æ··åˆå‹å±‹é ‚</label><div id="ph-roof_æ··åˆå‹å±‹é ‚" class="chips"></div>
      </div>
      <div class="sec">
        <div class="muted" style="margin-bottom:6px">æ˜¯å¦æœ‰éšœç¤™ç‰©ï¼ˆå¯è¤‡é¸ï¼‰</div>
        <label class="inline"><input type="checkbox" data-arr="obstacles" value="æ°´å¡”"> æ°´å¡”</label><div id="ph-obst_æ°´å¡”" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="obstacles" value="å†·æ°£"> å†·æ°£</label><div id="ph-obst_å†·æ°£" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="obstacles" value="é€šé¢¨çƒ"> é€šé¢¨çƒ</label><div id="ph-obst_é€šé¢¨çƒ" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="obstacles" value="å¤ªé™½èƒ½ç†±æ°´å™¨"> å¤ªé™½èƒ½ç†±æ°´å™¨</label><div id="ph-obst_å¤ªé™½èƒ½ç†±æ°´å™¨" class="chips"></div>
        <label class="inline">å…¶ä»– <input id="obst_other" type="text" placeholder="è‡ªå¡«"/></label><div id="ph-obst_å…¶ä»–" class="chips"></div>
      </div>
      <div class="sec">
        <div class="muted" style="margin-bottom:6px">æ˜¯å¦æœ‰é®é™°</div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="å±‹å‡¸"> å±‹å‡¸</label><div id="ph-shade_å±‹å‡¸" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="æ°´å¡”"> æ°´å¡”</label><div id="ph-shade_æ°´å¡”" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="é›»å¡”"> é›»å¡”</label><div id="ph-shade_é›»å¡”" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="å»£æ’­å¡”"> å»£æ’­å¡”</label><div id="ph-shade_å»£æ’­å¡”" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="å±±é®"> å±±é®</label><div id="ph-shade_å±±é®" class="chips"></div>
        <label class="inline"><input type="checkbox" data-arr="shades" value="é«˜æ¨“"> é«˜æ¨“ï¼ˆç´„ <input id="high_rise_f" type="number" style="width:90px"> æ¨“ï¼‰</label><div id="ph-shade_é«˜æ¨“" class="chips"></div>
      </div>
    </div>

    <div class="sec">
      <strong>â— åœ°é¢å‹</strong>
      <label class="inline"><input type="checkbox" data-arr="ground_types" value="ä¸€èˆ¬åœ°é¢å‹"> ä¸€èˆ¬åœ°é¢å‹</label><div id="ph-ground_ä¸€èˆ¬åœ°é¢å‹" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="ground_types" value="é¢¨é›¨çƒå ´"> é¢¨é›¨çƒå ´</label><div id="ph-ground_é¢¨é›¨çƒå ´" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="ground_types" value="åœè»Šå ´"> åœè»Šå ´</label><div id="ph-ground_åœè»Šå ´" class="chips"></div>
    </div>
  </div></section>

  <!-- 2 ç©ºæ‹ -->
  <section class="card"><div class="body">
    <h2>2) ç©ºæ‹</h2>
    <div class="sec">
      <label class="inline"><input type="checkbox" data-arr="drone" value="å¯ç©ºæ‹"> å¯ç©ºæ‹</label><div id="ph-drone_å¯ç©ºæ‹" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone" value="ç¦èˆªå€"> ç¦èˆªå€</label><div id="ph-drone_ç¦èˆªå€" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone" value="é™é«˜"> é™é«˜ï¼ˆ<input id="drone_limit" type="number" style="width:90px"> å…¬å°ºï¼‰</label><div id="ph-drone_é™é«˜" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="åŒ—é¢ç©ºæ‹"> åŒ—é¢ç©ºæ‹</label><div id="ph-dronedir_åŒ—é¢ç©ºæ‹" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="è¥¿é¢ç©ºæ‹"> è¥¿é¢ç©ºæ‹</label><div id="ph-dronedir_è¥¿é¢ç©ºæ‹" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="å—é¢ç©ºæ‹"> å—é¢ç©ºæ‹</label><div id="ph-dronedir_å—é¢ç©ºæ‹" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="æ±é¢ç©ºæ‹"> æ±é¢ç©ºæ‹</label><div id="ph-dronedir_æ±é¢ç©ºæ‹" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="drone_dir" value="æ­£90åº¦ç©ºæ‹"> æ­£90åº¦ç©ºæ‹</label><div id="ph-dronedir_æ­£90åº¦ç©ºæ‹" class="chips"></div>
    </div>
  </div></section>

  <!-- 3 é¥‹ç·š -->
  <section class="card"><div class="body">
    <h2>3) é¥‹ç·š</h2>
    <div class="sec">
      <label class="inline"><span class="muted" style="width:120px;display:inline-block">é¥‹ç·šä»£ç¢¼</span> <input id="feeder_code" type="text"/></label>
      <label class="inline"><span class="muted" style="width:120px;display:inline-block">é¥‹ç·šå®¹é‡ (kW)</span> <input id="feeder_kw" type="number"/></label>
    </div>
  </div></section>

  <!-- 4 çˆ¬æ¢¯ç‹€æ³ -->
  <section class="card"><div class="body">
    <h2>4) çˆ¬æ¢¯ç‹€æ³</h2>
    <div class="sec">
      <label class="inline">ç¾å ´æ˜¯å¦æœ‰æ—¢è¨­çˆ¬æ¢¯ <input type="radio" name="ladder_exist" value="æ˜¯"> æ˜¯ <input type="radio" name="ladder_exist" value="å¦" style="margin-left:14px"> å¦</label>
      <div id="ph-ladder_exist" class="chips" style="display:none"></div>
      <label class="inline">æ˜¯å¦éœ€è¦æ–°è¨­çˆ¬æ¢¯ <input type="radio" name="ladder_new" value="æ˜¯"> æ˜¯ <input type="radio" name="ladder_new" value="å¦" style="margin-left:14px"> å¦</label>
      <div id="ph-ladder_new" class="chips" style="display:none"></div>
    </div>
  </div></section>

  <!-- 5 ä½µæ¥é›»å£“ -->
  <section class="card"><div class="body">
    <h2>5) ä½µæ¥é›»å£“ç­‰ç´š</h2>
    <div class="sec">
      <label class="inline"><span class="muted" style="width:160px;display:inline-block">ä½µæ¥é›»å£“ç­‰ç´š (V)</span> <input id="grid_voltage" type="number" placeholder="ä¾‹å¦‚ï¼š380/11400/22800"/></label>
    </div>
  </div></section>

  <!-- 6 ä½µæ¥é» -->
  <section class="card"><div class="body">
    <h2>6) ä½µæ¥é»</h2>
    <div class="sec">
      <label class="inline"><input type="checkbox" data-arr="poc" value="æ–°è¨­å°é›»é…é›»é›»æ«ƒ+æ–°è¨­è²¬ä»»åˆ†ç•Œé»"> æ–°è¨­å°é›»é…é›»é›»æ«ƒ + æ–°è¨­è²¬ä»»åˆ†ç•Œé»</label><div id="ph-poc_æ–°è¨­å°é›»é…é›»é›»æ«ƒ+æ–°è¨­è²¬ä»»åˆ†ç•Œé»" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="poc" value="æ—¢è¨­å°é›»é…é›»é›»æ«ƒ+æ–°è¨­è²¬ä»»åˆ†ç•Œé»"> æ—¢è¨­å°é›»é…é›»é›»æ«ƒ + æ–°è¨­è²¬ä»»åˆ†ç•Œé»</label><div id="ph-poc_æ—¢è¨­å°é›»é…é›»é›»æ«ƒ+æ–°è¨­è²¬ä»»åˆ†ç•Œé»" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="poc" value="åƒ…æ—¢è¨­è²¬ä»»åˆ†ç•Œé»"> åƒ…æ—¢è¨­è²¬ä»»åˆ†ç•Œé»</label><div id="ph-poc_åƒ…æ—¢è¨­è²¬ä»»åˆ†ç•Œé»" class="chips"></div>
      <label class="inline"><input type="checkbox" data-arr="poc" value="ä½µå…§ç·š"> ä½µå…§ç·š</label><div id="ph-poc_ä½µå…§ç·š" class="chips"></div>
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">é›»è™Ÿ</span> <input id="meter_no" type="text" inputmode="numeric" placeholder="ä¾‹ï¼š1234567890"/></label>
    </div>
  </div></section>

  <!-- 7 è¨­å‚™é è¨ˆè¨­ç½®ä½ç½®ï¼ˆç…§ç‰‡åŒ–ï¼‰ -->
  <section class="card"><div class="body">
    <h2>7) è¨­å‚™é è¨ˆè¨­ç½®ä½ç½®</h2>
    <div class="sec">
      <div><span class="muted">å¤ªé™½å…‰é›»éŒ¶ç®±</span><div id="ph-loc_pv_meter" class="chips"></div></div>
      <div><span class="muted">æ©Ÿæˆ¿</span><div id="ph-loc_room" class="chips"></div></div>
      <div><span class="muted">é«˜å£“è¨­å‚™</span><div id="ph-loc_hv" class="chips"></div></div>
      <div><span class="muted">å°é›»é…é›»å ´</span><div id="ph-loc_taipower" class="chips"></div></div>
      <div><span class="muted">è‡ªå‚™æ¡¿</span><div id="ph-loc_pole" class="chips"></div></div>
      <div><span class="muted">é–‹é—œç®±</span><div id="ph-loc_switch" class="chips"></div></div>
    </div>
  </div></section>

  <!-- 8 æ–½å·¥è·¯ç·šèˆ‡æš«æ”¾ -->
  <section class="card"><div class="body">
    <h2>8) æ–½å·¥è·¯ç·šèˆ‡ç‰©æ–™æš«æ”¾</h2>
    <div class="sec">
      <label class="inline">ç¾å ´æ˜¯å¦æœ‰æ–½å·¥è·¯ç·š <input type="radio" name="has_route" value="å¦"> å¦ <input type="radio" name="has_route" value="æ˜¯" style="margin-left:14px"> æ˜¯</label>
      <div id="ph-route" class="chips" style="display:none"></div>
      <label class="inline">é“è·¯å¯¬ <input id="route_width" type="number" style="width:100px"> å…¬å°º</label>
      <label class="inline">ç¾å ´æ˜¯å¦æœ‰ç‰©æ–™æš«æ”¾å€ <input type="radio" name="has_staging" value="æ˜¯"> æ˜¯ <input type="radio" name="has_staging" value="å¦" style="margin-left:14px"> å¦</label>
    </div>
  </div></section>

  <!-- 9 æ—¢è¨­å®¹é‡ -->
  <section class="card"><div class="body">
    <h2>9) ç¾å ´æ—¢è¨­å¤ªé™½å…‰é›»å®¹é‡</h2>
    <div class="sec">
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">åç¨± 1</span> <input id="exist_name1" type="text" style="width:200px"> <span class="muted" style="width:90px;display:inline-block;margin-left:12px">å®¹é‡(kW)</span> <input id="exist_kw1" type="number" style="width:120px"></label>
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">åç¨± 2</span> <input id="exist_name2" type="text" style="width:200px"> <span class="muted" style="width:90px;display:inline-block;margin-left:12px">å®¹é‡(kW)</span> <input id="exist_kw2" type="number" style="width:120px"></label>
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">åç¨± 3</span> <input id="exist_name3" type="text" style="width:200px"> <span class="muted" style="width:90px;display:inline-block;margin-left:12px">å®¹é‡(kW)</span> <input id="exist_kw3" type="number" style="width:120px"></label>
      <label class="inline"><span class="muted" style="width:80px;display:inline-block">åç¨± 4</span> <input id="exist_name4" type="text" style="width:200px"> <span class="muted" style="width:90px;display:inline-block;margin-left:12px">å®¹é‡(kW)</span> <input id="exist_kw4" type="number" style="width:120px"></label>
    </div>
  </div></section>

  <!-- 10 ç‰¹åˆ¥ç´„å®šäº‹é … -->
  <section class="card"><div class="body">
    <h2>10) ç‰¹åˆ¥ç´„å®šäº‹é …</h2>
    <div class="sec">
      <label class="muted">ç‰¹åˆ¥ç´„å®šäº‹é …</label>
      <textarea id="special_notes" placeholder="è«‹å¡«å¯«é™åˆ¶ã€é…åˆäº‹é …ã€é‡Œç¨‹ç¢‘ç­‰â€¦"></textarea>
    </div>
  </div></section>
</main>

<footer class="toolbar">
  <div class="wrap">
    <button class="btn ghost" id="btnScrollTop">â¬†ï¸ å›åˆ°é ‚ç«¯</button>
    <button class="btn primary" id="btnExport">â¬‡ï¸ åŒ¯å‡ºPPT</button>
  </div>
  <div class="wrap"><div class="hint">æç¤ºï¼šæ‰‹æ©Ÿå¯ç›´æ¥æ‰“é–‹ç›¸æ©Ÿæ‹ç…§ä¸Šå‚³ï¼ˆä¸éœ€å®‰è£ Appï¼‰ã€‚</div></div>
</footer>

<script src="https://unpkg.com/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
<script src="app.js"></script>
<script>
  if ('serviceWorker' in navigator) window.addEventListener('load', ()=> navigator.serviceWorker.register('./sw.js'));
</script>
</body>
</html>
